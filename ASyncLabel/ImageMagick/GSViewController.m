//
//  ViewController.m
//  ImageMagick
//
//  Created by birney on 2017/9/26.
//  Copyright Â© 2017å¹´ one. All rights reserved.
//

#import "GSViewController.h"
#import "GSTestViewCell.h"
#import "GSTextAttribute.h"
#import "GSTestFlowLayout.h"
#import "GSTestHeaderView.h"

@interface GSViewController ()
@property (nonatomic,strong) NSMutableArray<NSAttributedString*>* dataSource;
@property (nonatomic,strong) NSMutableDictionary<NSString*,NSNumber*>* usageCountDic;
@property (nonatomic,weak) GSTestHeaderView* header;
@property (nonatomic,assign) BOOL loading;
@property (nonatomic,weak) GSTestFlowLayout* layout;
@property (nonatomic,assign) BOOL end;
@property (nonatomic,assign) NSUInteger random;
@property (nonatomic,assign) NSUInteger pullCount;
@end

/// CollectionView ä¸‹æ‹‰åˆ·æ–°çš„å¤„ç†æ–¹å¼

@implementation GSViewController

static NSString * const reuseIdentifier = @"Cell";
#pragma mark - properties

- (NSUInteger)random {
    if (!_random) {
        _random = arc4random() % 20;
        _random = _random > 0 ? _random : 1;
    }
    return _random;
}

- (NSMutableArray*)dataSource {
  if (!_dataSource) {
    _dataSource = [[NSMutableArray alloc] init];
    
    
//    for (int i = 0; i < self.random; i++) {
//        ///
//        NSString* text = [NSString stringWithFormat:@"%d github:https://www.github.com/birneysky 89 å¹´ï¼Œé©¬åŒ–è…¾é«˜è€ƒã€‚93 å¹´ï½ž98 å¹´ï¼Œä»–åœ¨å¯»å‘¼æœºå…¬å¸å·¥ä½œã€‚98 å¹´å¼€å§‹åˆ›ä¸šã€‚å½“æ—¶åˆ›ä¸šçš„ 5 ä½åˆä¼™äººæ˜¯ï¼šé©¬åŒ–è…¾ï¼Œå¼ å¿—ä¸œï¼Œé™ˆä¸€ä¸¹ï¼Œè®¸æ™¨æ™”ï¼Œæ›¾æŽé’ã€‚è€Œ OICQ æœ¬æ¥æ˜¯ä»–ä»¬æ‰“ç®—æ‹¿æ¥ç«žæ ‡çš„äº§å“ï¼Œä½†æ˜¯ç«žæ ‡å¤±è´¥ï¼Œå¤§å®¶æ¿€çƒˆè®¨è®ºä¹‹åŽï¼Œé©¬åŒ–è…¾è¿˜æ˜¯å†³å®šè¦åšã€‚è™½ç„¶ä¸çŸ¥é“æ€Žä¹ˆæŒ£é’±ï¼Œä½†æ˜¯é©¬åŒ–è…¾è¿˜æ˜¯æ‰“ç®—ã€Œå…»ã€è¿™ä¸ªäº§å“ã€‚http://www.baidu.com ä¸€å¼€å§‹OICQå°±åœ¨äº§å“å’ŒæŠ€æœ¯ä¸Šå±•çŽ°å‡ºå¼ºå¤§çš„ç«žäº‰åŠ›13260398606 å±žäºŽå·¨å¤§çš„ç«žäº‰åŠ›â—Ÿ(âˆ—â›à¸±á´—â›à¸±âˆ—)â—žâœº ðŸ˜€ðŸ˜–ðŸ˜ðŸš‹ðŸŽŠðŸ˜¡ðŸš–ðŸšŒðŸ’–ðŸ’—ðŸ’›ðŸ’™ðŸ¨âœºâ—Ÿ(âˆ—â›à¸±á´—â›à¸±âˆ—)â—žâœº ðŸ˜€ðŸ˜–ðŸ˜ðŸ˜£ðŸ˜¡ðŸš–ðŸšŒðŸš‹ðŸŽŠðŸ˜¡ðŸš–ðŸšŒðŸ’–ðŸ’—ðŸ’›ðŸ’™ðŸ¨ ",i];
//        NSAttributedString* attributedString = [self generateAttributedString:text];
//      [_dataSource addObject:attributedString];
//    }
  }
  return _dataSource;
}
- (NSMutableDictionary<NSString*,NSNumber*>*)usageCountDic {
    if (!_usageCountDic) {
        _usageCountDic = [[NSMutableDictionary alloc] initWithCapacity:10];
    }
    return _usageCountDic;
}

#pragma mark - override
- (void)viewDidLoad {
    [super viewDidLoad];
    self.collectionView.backgroundColor = [UIColor colorNamed:@"test_blue"];
    self.collectionView.alwaysBounceVertical = YES;
    
    GSTestFlowLayout* layout = (GSTestFlowLayout*)self.collectionView.collectionViewLayout;;
    layout.itemSize = CGSizeMake(375, 100);
    layout.minimumLineSpacing = 10;
    layout.minimumInteritemSpacing = 10;
    //layout.headerReferenceSize = CGSizeMake(375, 30);
    self.layout = layout;
    self.end = YES;
    [self.collectionView registerClass:[GSTestHeaderView class] forSupplementaryViewOfKind:UICollectionElementKindSectionHeader withReuseIdentifier:@"TestHeaderView"];
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        sleep(1);
        dispatch_async(dispatch_get_main_queue(), ^{
            self.end = NO;
            self.loading = YES;
            CGPoint offset = self.collectionView.contentOffset;
            offset.y += 30;
            [UIView setAnimationsEnabled:NO];
            [self.collectionView.collectionViewLayout invalidateLayout];
            [self.collectionView setCollectionViewLayout:layout];
            [self.collectionView performBatchUpdates:^{
                self.collectionView.contentOffset = offset;
            } completion:^(BOOL finished) {
                NSLog(@"ðŸ˜“ðŸ˜“ðŸ˜“ðŸ˜“ðŸ˜“ðŸ˜“ðŸ˜“ performBatchUpdates");
                self.loading = NO;
                [UIView setAnimationsEnabled:YES];
            }];

//            [self.collectionView scrollToItemAtIndexPath:<#(nonnull NSIndexPath *)#> atScrollPosition:<#(UICollectionViewScrollPosition)#> animated:<#(BOOL)#>]
        });
    });
//    [self.collectionView scrollToItemAtIndexPath:[NSIndexPath indexPathForItem:19 inSection:0] atScrollPosition:UICollectionViewScrollPositionBottom animated:NO];
}

- (NSAttributedString*)generateAttributedString:(NSString*)text {
    GSTextAttribute* defaultAttribute = [GSTextAttribute defaultAttribute];
    NSMutableAttributedString* resultAttributedString =
        [[NSMutableAttributedString alloc] initWithString:text attributes:defaultAttribute.attributes];
    NSError *error;
    NSTextCheckingTypes checkingTypes = NSTextCheckingTypeLink|NSTextCheckingTypePhoneNumber;
    NSDataDetector *dataDetector = [[NSDataDetector alloc] initWithTypes:checkingTypes error:&error];
    GSTextAttribute* linkAttribute = [[GSTextAttribute alloc] init];
    linkAttribute.foregroundcolor = [UIColor blueColor];
    
    
    GSTextHighlightedAttribute* heightLinght = [GSTextHighlightedAttribute defaultTextHiglightedAttribute];
    
    if (!error) {
        void (^usingBlock)(NSTextCheckingResult * _Nullable result, NSMatchingFlags flags, BOOL *stop)
        = ^(NSTextCheckingResult *result, NSMatchingFlags flags, BOOL *stop) {
                [resultAttributedString addAttributes:linkAttribute.attributes
                                                range:result.range];
                [resultAttributedString addAttribute:GSTextHighlightedAttribute.name value:heightLinght range:result.range];

        };
        [dataDetector enumerateMatchesInString:text
                                       options:kNilOptions
                                         range:NSMakeRange(0, text.length)
                                    usingBlock:usingBlock];
    }

    return [resultAttributedString copy];
}

- (void)scrollViewDidScroll:(UIScrollView *)scrollView {
    NSLog(@"ðŸ˜“ðŸ˜“ðŸ˜“ðŸ˜“ðŸ˜“ðŸ˜“ðŸ˜“ offset %@",NSStringFromCGPoint(scrollView.contentOffset));
    if (scrollView.contentOffset.y <= -58 && !self.loading && !self.end) {
        self.loading = YES;
        [self.header startAnimating];
        [self performSelector:@selector(insertNewItem) withObject:nil afterDelay:0.8f];
    } 
}

#pragma mark <UICollectionViewDataSource>
//
//- (NSInteger)numberOfSectionsInCollectionView:(UICollectionView *)collectionView {
//    return 1;
//}

- (NSInteger)collectionView:(UICollectionView *)collectionView numberOfItemsInSection:(NSInteger)section {
    return self.dataSource.count;
}

- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath {
    GSTestViewCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:reuseIdentifier forIndexPath:indexPath];
    
    cell.label.attributedText = self.dataSource[indexPath.row];
    cell.backgroundColor = [UIColor redColor];
    NSString* cellIdentifier = [NSString stringWithFormat:@"%p",cell];
    if (self.usageCountDic[cellIdentifier]) {
        NSInteger usageCount = [self.usageCountDic[cellIdentifier] integerValue];
        self.usageCountDic[cellIdentifier] = @(usageCount+1);
    } else {
        self.usageCountDic[cellIdentifier] = @1;
    }
   
    NSLog(@"cellForRowAtIndexPath row %zd %p cell count %zd usageCount %@",indexPath.row,cell,self.usageCountDic.count,self.usageCountDic[cellIdentifier]);
    return cell;
}

- (UICollectionReusableView*)collectionView:(UICollectionView *)collectionView viewForSupplementaryElementOfKind:(NSString *)kind atIndexPath:(NSIndexPath *)indexPath {
    UICollectionReusableView* header = [collectionView dequeueReusableSupplementaryViewOfKind:kind withReuseIdentifier:@"TestHeaderView" forIndexPath:indexPath];
    self.header = (GSTestHeaderView*)header;
    return header;
}

- (CGSize)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout referenceSizeForHeaderInSection:(NSInteger)section {
    CGFloat width = self.collectionView.frame.size.width;
    return (CGSize){width, self.end ? 0 : 30};
}


- (CGSize)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout sizeForItemAtIndexPath:(NSIndexPath *)indexPath {
    return CGSizeMake(375, 100);
}



#pragma mark <UICollectionViewDelegate>

- (void)collectionView:(UICollectionView *)collectionView willDisplayCell:(UICollectionViewCell *)cell forItemAtIndexPath:(NSIndexPath *)indexPath {
    NSString* cellIdentifier = [NSString stringWithFormat:@"%p",cell];
         NSLog(@"willDisplayCell  forItemAtIndexPath row %zd %p cell count %zd usageCount %@",indexPath.row,cell,self.usageCountDic.count,self.usageCountDic[cellIdentifier]);
}



/*
// Uncomment this method to specify if the specified item should be highlighted during tracking
- (BOOL)collectionView:(UICollectionView *)collectionView shouldHighlightItemAtIndexPath:(NSIndexPath *)indexPath {
	return YES;
}
*/

/*
// Uncomment this method to specify if the specified item should be selected
- (BOOL)collectionView:(UICollectionView *)collectionView shouldSelectItemAtIndexPath:(NSIndexPath *)indexPath {
    return YES;
}
*/

/*
// Uncomment these methods to specify if an action menu should be displayed for the specified item, and react to actions performed on the item
- (BOOL)collectionView:(UICollectionView *)collectionView shouldShowMenuForItemAtIndexPath:(NSIndexPath *)indexPath {
	return NO;
}

- (BOOL)collectionView:(UICollectionView *)collectionView canPerformAction:(SEL)action forItemAtIndexPath:(NSIndexPath *)indexPath withSender:(id)sender {
	return NO;
}

- (void)collectionView:(UICollectionView *)collectionView performAction:(SEL)action forItemAtIndexPath:(NSIndexPath *)indexPath withSender:(id)sender {
	
}
*/
#pragma mark - Helper
- (void)insertNewItem {
    if (self.end) {
        return;
    }
    static NSInteger index = -1;
    NSMutableArray* indexPathes = [[NSMutableArray alloc] init];
    CGFloat height = 0;
    NSUInteger count = arc4random() % 10;
    count = count == 0 ? 1 : count;
    for (int i = 0; i < count; i++) {
        NSString* text = [NSString stringWithFormat:@"%ld github:https://www.github.com/birneysky 89 å¹´ï¼Œé©¬åŒ–è…¾é«˜è€ƒã€‚93 å¹´ï½ž98 å¹´ï¼Œä»–åœ¨å¯»å‘¼æœºå…¬å¸å·¥ä½œã€‚98 å¹´å¼€å§‹åˆ›ä¸šã€‚å½“æ—¶åˆ›ä¸šçš„ 5 ä½åˆä¼™äººæ˜¯ï¼šé©¬åŒ–è…¾ï¼Œå¼ å¿—ä¸œï¼Œé™ˆä¸€ä¸¹ï¼Œè®¸æ™¨æ™”ï¼Œæ›¾æŽé’ã€‚è€Œ OICQ æœ¬æ¥æ˜¯ä»–ä»¬æ‰“ç®—æ‹¿æ¥ç«žæ ‡çš„äº§å“ï¼Œä½†æ˜¯ç«žæ ‡å¤±è´¥ï¼Œå¤§å®¶æ¿€çƒˆè®¨è®ºä¹‹åŽï¼Œé©¬åŒ–è…¾è¿˜æ˜¯å†³å®šè¦åšã€‚è™½ç„¶ä¸çŸ¥é“æ€Žä¹ˆæŒ£é’±ï¼Œä½†æ˜¯é©¬åŒ–è…¾è¿˜æ˜¯æ‰“ç®—ã€Œå…»ã€è¿™ä¸ªäº§å“ã€‚http://www.baidu.com ä¸€å¼€å§‹OICQå°±åœ¨äº§å“å’ŒæŠ€æœ¯ä¸Šå±•çŽ°å‡ºå¼ºå¤§çš„ç«žäº‰åŠ›13260398606 å±žäºŽå·¨å¤§çš„ç«žäº‰åŠ›â—Ÿ(âˆ—â›à¸±á´—â›à¸±âˆ—)â—žâœº ðŸ˜€ðŸ˜–ðŸ˜ðŸš‹ðŸŽŠðŸ˜¡ðŸš–ðŸšŒðŸ’–ðŸ’—ðŸ’›ðŸ’™ðŸ¨âœºâ—Ÿ(âˆ—â›à¸±á´—â›à¸±âˆ—)â—žâœº ðŸ˜€ðŸ˜–ðŸ˜ðŸ˜£ðŸ˜¡ðŸš–ðŸšŒðŸš‹ðŸŽŠðŸ˜¡ðŸš–ðŸšŒðŸ’–ðŸ’—ðŸ’›ðŸ’™ðŸ¨ ",(long)index];
        NSAttributedString* attributedString = [self generateAttributedString:text];
        [self.dataSource insertObject:attributedString atIndex:0];
        index --;
        CGSize itemSize = [self collectionView:self.collectionView layout:nil sizeForItemAtIndexPath:[NSIndexPath indexPathForItem:0 inSection:0]];
        height += itemSize.height;
        height += 10;
        [indexPathes addObject:[NSIndexPath indexPathForItem:i inSection:0]];
    }

    self.end = arc4random() % 10 == 5;
    self.layout.keepOffset = NO;
    CGSize contentSize = self.collectionView.contentSize;
    contentSize.height += height;
    if (self.end) {
        contentSize.height -=30;
    }
    self.layout.newContentSize = contentSize;
    
    self.pullCount += count;
    [UIView setAnimationsEnabled:NO];
    [self.collectionView performBatchUpdates:^{
        [self.collectionView insertItemsAtIndexPaths:indexPathes];
                NSLog(@"ðŸ˜“ðŸ˜“ðŸ˜“ðŸ˜“ðŸ˜“ðŸ˜“ðŸ˜“ðŸ˜“ insertItemsAtIndexPaths contentSize %@ ",NSStringFromCGSize(self.collectionView.contentSize));
        //     [self.collectionView reloadData];
    } completion:^(BOOL finished) {
        [UIView setAnimationsEnabled:YES];
        self.loading = NO;
        NSLog(@"ðŸ˜“ðŸ˜“ðŸ˜“ðŸ˜“ðŸ˜“ðŸ˜“ðŸ˜“ðŸ˜“ performBatchUpdates completion contentSize %@ ",NSStringFromCGSize(self.collectionView.contentSize));
        if (self.end) {
            UICollectionViewLayout* layout = self.collectionView.collectionViewLayout;
            [self.collectionView.collectionViewLayout invalidateLayout];
            [self.collectionView setCollectionViewLayout:layout];
        }
    }];
}

- (void)addNewItem {
    NSUInteger index = self.dataSource.count - self.random - self.pullCount;
    index += self.random;
    UICollectionViewCell* cell = [self.collectionView cellForItemAtIndexPath:[NSIndexPath indexPathForItem:self.dataSource.count-1 inSection:0]];
    NSMutableArray* indexPathes = [[NSMutableArray alloc] init];
    CGFloat height = 0;
    NSUInteger count = arc4random() % 10;
    count = count == 0 ? 1 : count;
    for (int i = 0; i < 1; i++) {
        NSString* text = [NSString stringWithFormat:@"%ld github:https://www.github.com/birneysky 89 å¹´ï¼Œé©¬åŒ–è…¾é«˜è€ƒã€‚93 å¹´ï½ž98 å¹´ï¼Œä»–åœ¨å¯»å‘¼æœºå…¬å¸å·¥ä½œã€‚98 å¹´å¼€å§‹åˆ›ä¸šã€‚å½“æ—¶åˆ›ä¸šçš„ 5 ä½åˆä¼™äººæ˜¯ï¼šé©¬åŒ–è…¾ï¼Œå¼ å¿—ä¸œï¼Œé™ˆä¸€ä¸¹ï¼Œè®¸æ™¨æ™”ï¼Œæ›¾æŽé’ã€‚è€Œ OICQ æœ¬æ¥æ˜¯ä»–ä»¬æ‰“ç®—æ‹¿æ¥ç«žæ ‡çš„äº§å“ï¼Œä½†æ˜¯ç«žæ ‡å¤±è´¥ï¼Œå¤§å®¶æ¿€çƒˆè®¨è®ºä¹‹åŽï¼Œé©¬åŒ–è…¾è¿˜æ˜¯å†³å®šè¦åšã€‚è™½ç„¶ä¸çŸ¥é“æ€Žä¹ˆæŒ£é’±ï¼Œä½†æ˜¯é©¬åŒ–è…¾è¿˜æ˜¯æ‰“ç®—ã€Œå…»ã€è¿™ä¸ªäº§å“ã€‚http://www.baidu.com ä¸€å¼€å§‹OICQå°±åœ¨äº§å“å’ŒæŠ€æœ¯ä¸Šå±•çŽ°å‡ºå¼ºå¤§çš„ç«žäº‰åŠ›13260398606 å±žäºŽå·¨å¤§çš„ç«žäº‰åŠ›â—Ÿ(âˆ—â›à¸±á´—â›à¸±âˆ—)â—žâœº ðŸ˜€ðŸ˜–ðŸ˜ðŸš‹ðŸŽŠðŸ˜¡ðŸš–ðŸšŒðŸ’–ðŸ’—ðŸ’›ðŸ’™ðŸ¨âœºâ—Ÿ(âˆ—â›à¸±á´—â›à¸±âˆ—)â—žâœº ðŸ˜€ðŸ˜–ðŸ˜ðŸ˜£ðŸ˜¡ðŸš–ðŸšŒðŸš‹ðŸŽŠðŸ˜¡ðŸš–ðŸšŒðŸ’–ðŸ’—ðŸ’›ðŸ’™ðŸ¨ ",(long)index];
        NSAttributedString* attributedString = [self generateAttributedString:text];
        index = self.dataSource.count + i;
        [self.dataSource addObject:attributedString];
        [indexPathes addObject:[NSIndexPath indexPathForItem:index inSection:0]];
        //index ++;
        CGSize itemSize = [self collectionView:self.collectionView layout:nil sizeForItemAtIndexPath:[NSIndexPath indexPathForItem:0 inSection:0]];
        height += itemSize.height;
        height += 10;
    }
    
    CGSize contentSize = self.collectionView.contentSize;
    contentSize.height += height;
    self.layout.keepOffset = !cell?YES:NO;
    self.layout.newContentSize = contentSize;
    [self.collectionView performBatchUpdates:^{
        [self.collectionView insertItemsAtIndexPaths:indexPathes];
    } completion:^(BOOL finished) {
        
    }];
    
}

#pragma mark - Target Action

- (IBAction)updateAction:(id)sender {
    [self addNewItem];
}
@end



/*
 Abc45678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890 12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901def
 
 */
